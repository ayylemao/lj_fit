# LJ fitting program to fit LJ parameters to DFT ab inito data

Normal Compilation:

gfortran differential_evolution.f90 graphf.f90 dijkstra.f90 utils_lj_fit.f90 lj_fit.f90 -o lj_fit.x

Paralell compilation with OpenMP:

gfortran -fopenmp -O2 differential evolution.f90 graphf.f90 dijkstra.f90 utils_lj_fit.f90 lj_fit.f90 -o lj_fit.x

# Usage

./lj_fit.x \<CHFF LJ param file\> \<CHFF one four param file\> \<one four species file\> \<system psf file\> \<bond data file\> \<crd path file\> 
            \<atom labels to optimize\>
            \<reference energy file\> \<number of geometries\> \<number of atoms in the solute\> \<number of one four species in the system\>
            \<N DE generations\> \<lower bound for feasability constraint\> \<upper bound for feasabilty constraint\> 
            \<scaling factor for the RMSE penalty\>
            
           

# Explanation of parameter files:

**\<CHFF LJ param file\>**: File containing the LJ parameters for all atom species defined in the CHARMM par_all36_prot.prm file.
  
**\<CHFF one four param file\>**: File containing ONE-FOUR LJ interaction parameters for all atom types in par_all36_prot.prm. If there are none defined, the normal LJ parameters are taken.
  
**\<one four atom types\>**: File listing the atom types within par_all36_prot.prm having ONE-FOUR LJ interactions defined
  
**\<system psf file\>**: The psf file for the system in question, generated by CHARMM
  
**\<bond data file\>**: File containing the bond data. Each line has a pair of atom indices that are bonded together
  
**\<crd path file\>**: File containing the paths to each individual .crd file generated by CHARMM.
  
**\<atom labels to optimize\>**: File containing the LJ atom labels of the atom types to optimize
  
**\<reference energy file\>**: File containing the reference energy to optimize against. The ordering of the energies should correspond to the crd path file
  
**\<number of geometries\>**: Integer telling the programm how many geometries are to be considered (should not exceed the the number of paths in the crd 
 path file.
  
**\<number of atoms in solute\>**: Integer telling the programm how many atoms are in the solute
  
**\<number of one four species in the system\>**: Integer telling the number of ONE-FOUR species are in the system.
  
**\<N DE generations\>**: Integer telling the program the maximum amount of DE generations to run
  
**\<lower bound for feasability constraint\>**: Floating point number telling the program the lower bound of feasability in the search range
  
**\<upper bound for feasability constraint\>**: Floating point number telling the program the upper bound of feasability in the search range
  
**\<scaling factor for the RMSE penalty\>**: Scaling of the RMSE penalty added for straying to far from the original CHFF LJ value
  
  
  
# Example

By running the compile_par.sh script, a working example of the fitting program should compile and execute. For using a different system, please refer to this file and the files referenced therein. Most of the parameter files passed to the program have headers indicating how many lines are to be read by the Fortran code. 
